<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Relax Touch â€” Realistic & Calm</title>
<style>
  :root{
    --ui-bg: rgba(0,0,0,.35);
    --ui-text: #f3fbff;
    --ui-shadow: 0 10px 24px rgba(0,0,0,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    overflow:hidden;
    touch-action:none;
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
    background:#000;
  }
  #stage{position:fixed; inset:0; width:100%; height:100%; display:block;}
  .dock{
    position:fixed; right:14px; bottom:14px; z-index:3; display:flex; gap:10px; align-items:flex-end;
  }
  .btn{
    width:48px; height:48px; border-radius:50%;
    display:grid; place-items:center; cursor:pointer; user-select:none;
    color:var(--ui-text); background:var(--ui-bg); box-shadow:var(--ui-shadow);
    backdrop-filter: blur(6px);
  }
  .btn:active{ transform: translateY(1px); }
  .panel{
    position:fixed; right:14px; bottom:70px; z-index:3; display:none;
    background:var(--ui-bg); color:var(--ui-text);
    padding:10px; border-radius:12px; box-shadow:var(--ui-shadow);
    backdrop-filter: blur(8px); max-height:70vh; overflow:auto;
  }
  .swatch{
    width:240px; max-width:70vw; display:grid; grid-template-columns:1fr 44px; align-items:center; gap:10px;
    padding:8px; border-radius:10px; cursor:pointer; user-select:none;
  }
  .swatch + .swatch{ margin-top:6px; }
  .swatch:hover{ background: rgba(255,255,255,.08); }
  .preview{ width:44px; height:24px; border-radius:6px; box-shadow: inset 0 0 0 1px rgba(255,255,255,.15); }
  .label{ font-size:14px; }
</style>
</head>
<body>
<canvas id="stage"></canvas>

<div class="dock">
  <div class="btn" id="effectBtn" title="Effects">ðŸª„</div>
  <div class="btn" id="themeBtn" title="Themes">ðŸŽ¨</div>
</div>
<div class="panel" id="effectPanel"></div>
<div class="panel" id="themePanel"></div>

<script>
(() => {
  const dpr = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
  const canvas = document.getElementById('stage');
  const ctx = canvas.getContext('2d', { alpha: false });
  let W = 0, H = 0;
  function resize(){
    W = canvas.clientWidth;
    H = canvas.clientHeight;
    canvas.width  = (W*dpr)|0;
    canvas.height = (H*dpr)|0;
    ctx.setTransform(dpr,0,0,dpr,0,0);
  }
  window.addEventListener('resize', resize, {passive:true}); resize();

  // THEMES (softer palettes + trail tinting)
  const THEMES = [
    { name:'Ocean Calm', bg:(w,h)=>gradRad([[0,'#052a2a'],[1,'#0b1718']], w*.5,h*.35, Math.max(w,h)), cols:['#9ff7e8','#67e2c9','#b2fff7'], trail:0.055, tint:'rgba(5,18,19,0.06)', comp:'lighter' },
    { name:'Purple Dusk', bg:(w,h)=>gradRad([[0,'#211033'],[1,'#0b0b1a']], w*.5,h*.5, Math.max(w,h)), cols:['#f3b8ff','#c5a1ff','#9dbbff'], trail:0.06, tint:'rgba(14,10,24,0.06)', comp:'lighter' },
    { name:'Sunrise Peach', bg:(w,h)=>gradRad([[0,'#f3a37f'],[1,'#5d2726']], w*.55,h*.28, Math.max(w,h)), cols:['#fff4be','#ffd9b6','#ffd0df'], trail:0.05, tint:'rgba(50,20,20,0.06)', comp:'lighter' },
    { name:'Forest Mist', bg:(w,h)=>gradRad([[0,'#0b2b1d'],[1,'#061512']], w*.4,h*.4, Math.max(w,h)), cols:['#bafbd8','#8de0bf','#d4ffe6'], trail:0.05, tint:'rgba(6,15,12,0.06)', comp:'lighter' },
    { name:'Mono Zen', bg:(w,h)=>gradRad([[0,'#141414'],[1,'#000000']], w*.5,h*.5, Math.max(w,h)), cols:['#f6f6f6','#dcdcdc','#bdbdbd'], trail:0.06, tint:'rgba(0,0,0,0.06)', comp:'lighter' },
  ];
  function gradRad(stops,cx,cy,r){
    const g = ctx.createRadialGradient(cx,cy,0,cx,cy,r);
    for(const s of stops) g.addColorStop(s[0], s[1]);
    return g;
  }
  let theme = THEMES[0];

  // EFFECT MODES (softer/realistic tuning)
  const EFFECTS = [
    {name:'Soft Ripples'},       // 0
    {name:'Floral Mist'},        // 1
    {name:'Calm Sparkles'},      // 2
    {name:'Ink Drift'},          // 3
    {name:'Slow Swirls'},        // 4
    {name:'Light Rays'},         // 5
    {name:'Glass Shards (soft)'},// 6
    {name:'Air Bubbles'},        // 7
  ];
  let effectMode = 0;

  // Panels
  const themeBtn = document.getElementById('themeBtn');
  const effectBtn = document.getElementById('effectBtn');
  const themePanel = document.getElementById('themePanel');
  const effectPanel = document.getElementById('effectPanel');

  function buildPanel(panel, items, onPick){
    panel.innerHTML='';
    items.forEach((t,i)=>{
      const row = document.createElement('div');
      row.className='swatch';
      const lab = document.createElement('div'); lab.className='label'; lab.textContent=t.name || t;
      const prev = document.createElement('div'); prev.className='preview';
      const cvs = document.createElement('canvas'); cvs.width=44; cvs.height=24;
      const c2 = cvs.getContext('2d');
      const g = c2.createLinearGradient(0,0,44,24);
      if(t.cols){
        g.addColorStop(0,t.cols[0]); g.addColorStop(.5,t.cols[1]); g.addColorStop(1,t.cols[2]);
      } else {
        g.addColorStop(0,'#fff'); g.addColorStop(1,'#000');
      }
      c2.fillStyle=g; c2.fillRect(0,0,44,24);
      prev.style.backgroundImage=`url(${cvs.toDataURL()})`; prev.style.backgroundSize='cover';
      row.appendChild(lab); row.appendChild(prev);
      row.addEventListener('click',()=>{ onPick(i); toggle(panel,false); });
      panel.appendChild(row);
    });
  }
  buildPanel(themePanel, THEMES, (i)=>theme=THEMES[i]);
  buildPanel(effectPanel, EFFECTS, (i)=>effectMode=i);

  function toggle(el,show){ el.style.display = show?'block':'none'; }
  let themeOpen=false, effectOpen=false;
  themeBtn.addEventListener('pointerdown', ()=>{ themeOpen=!themeOpen; toggle(themePanel,themeOpen); toggle(effectPanel,false); effectOpen=false; });
  effectBtn.addEventListener('pointerdown', ()=>{ effectOpen=!effectOpen; toggle(effectPanel,effectOpen); toggle(themePanel,false); themeOpen=false; });
  window.addEventListener('pointerdown', (e)=>{
    if(e.target!==themeBtn && !themePanel.contains(e.target)){ toggle(themePanel,false); themeOpen=false; }
    if(e.target!==effectBtn && !effectPanel.contains(e.target)){ toggle(effectPanel,false); effectOpen=false; }
  });

  // Entities
  const ents = [];
  const MAX = 1000;
  function addEnt(o){ if(ents.length>=MAX) ents.shift(); ents.push(o); }
  function rnd(a,b){ return a + Math.random()*(b-a); }

  // Velocity smoothing for more natural feel
  const pointers = new Map(); // id -> {x,y,px,py,t,vSmooth,carry}
  function onDown(e){
    const rect=canvas.getBoundingClientRect();
    const x=e.clientX-rect.left, y=e.clientY-rect.top;
    const id=e.pointerId||0;
    pointers.set(id,{x,y,px:x,py:y,t:performance.now(),vSmooth:0,carry:0});
    spawn(x,y, 0.1); // gentle initial
  }
  function onMove(e){
    const P=pointers.get(e.pointerId||0); if(!P) return;
    const rect=canvas.getBoundingClientRect();
    const x=e.clientX-rect.left, y=e.clientY-rect.top;
    const now=performance.now();
    const dx=x-P.x, dy=y-P.y; const dist=Math.hypot(dx,dy);
    const dt=Math.max(1, now-P.t);
    const vel=dist/dt; // px/ms
    // smooth velocity (easing)
    P.vSmooth = P.vSmooth*0.8 + vel*0.2;
    const vNorm = Math.min(1, P.vSmooth / 1.0); // softer scale
    const step = 16 - vNorm*10; // slower baseline
    P.carry += dist;
    while(P.carry >= step){
      P.carry -= step;
      const t = (step-P.carry)/(dist||1);
      const ex = P.x + dx*t, ey = P.y + dy*t;
      spawn(ex,ey, vNorm);
    }
    P.px=P.x; P.py=P.y; P.x=x; P.y=y; P.t=now;
  }
  function onUp(e){
    const P=pointers.get(e.pointerId||0); if(!P) return;
    spawn(P.x,P.y, 0.05); // soft tail
    pointers.delete(e.pointerId||0);
  }
  canvas.addEventListener('pointerdown', onDown);
  window.addEventListener('pointermove', onMove);
  window.addEventListener('pointerup', onUp);
  window.addEventListener('pointercancel', onUp);
  window.addEventListener('pointerleave', onUp);

  // Ambient micro ripples
  let ambientT = 0;
  function ambient(dt){
    ambientT += dt;
    if(ambientT > 1.5){ // every ~1.5s
      ambientT = 0;
      addEnt({mode:0, x:rnd(W*0.2,W*0.8), y:rnd(H*0.2,H*0.8), r:0, rSp:rnd(0.4,0.9), a:0.4, lw:rnd(1.5,2.5), col: pick(theme.cols)});
    }
  }

  function pick(arr){ return arr[Math.random()*arr.length|0]; }

  // Spawner (relaxed parameters)
  function spawn(x,y, vNorm){
    const col = pick(theme.cols);
    switch(effectMode){
      case 0: { // Soft Ripples
        const count = 3 + (vNorm*4|0);
        for(let i=0;i<count;i++){
          addEnt({mode:0, x,y, r:0, rSp:rnd(0.6,1.1)+vNorm*0.8, a:0.8, lw:rnd(1.5,3), col});
        }
        break;
      }
      case 1: { // Floral Mist
        const petals = 8 + (vNorm*8|0);
        const R = rnd(24,40);
        for(let i=0;i<petals;i++){
          const ang = (i/petals)*Math.PI*2 + rnd(-.15,.15);
          addEnt({mode:1, x,y, dx:Math.cos(ang)*R, dy:Math.sin(ang)*R, rot:ang+Math.PI/2, t:0, life:rnd(900,1400), w:rnd(8,12), h:rnd(16,22), col, alpha:0.8});
        }
        break;
      }
      case 2: { // Calm Sparkles
        const n = 6 + (vNorm*10|0);
        for(let i=0;i<n;i++){
          addEnt({mode:2, x,y, vx:rnd(-120,120), vy:rnd(-120,120), a:0.8, size:rnd(2,3), spin:rnd(-3,3), col});
        }
        break;
      }
      case 3: { // Ink Drift
        const n = 1 + (vNorm*2|0);
        for(let i=0;i<n;i++){
          addEnt({mode:3, x,y, r:0, rSp:rnd(18,26)+vNorm*16, a:.22, col});
        }
        break;
      }
      case 4: { // Slow Swirls
        const arms = 12 + (vNorm*10|0);
        const baseR = rnd(10,18);
        for(let i=0;i<arms;i++){
          const ang = (i/arms)*Math.PI*2;
          addEnt({mode:4, x,y, ang, r:baseR, a:0.8, w:rnd(10,16), col});
        }
        break;
      }
      case 5: { // Light Rays
        const beams = 12 + (vNorm*16|0);
        for(let i=0;i<beams;i++){
          const ang = rnd(0,Math.PI*2);
          addEnt({mode:5, x,y, ang, len:rnd(12,36), a:0.7, w:rnd(1.5,3), speed:rnd(80,160), col});
        }
        break;
      }
      case 6: { // Glass Shards (soft, rounded)
        const n = 8 + (vNorm*12|0);
        for(let i=0;i<n;i++){
          addEnt({mode:6, x,y, vx:rnd(-160,160), vy:rnd(-160,160), a:0.7, size:rnd(8,14), rot:rnd(0,Math.PI), col});
        }
        break;
      }
      case 7: { // Air Bubbles
        const n = 8 + (vNorm*10|0);
        for(let i=0;i<n;i++){
          addEnt({mode:7, x,y, vy:rnd(-140,-60), vx:rnd(-30,30), r:rnd(4,10), a:0.8, col});
        }
        break;
      }
    }
  }

  // Drawing helpers
  function roundPetal(x,y,w,h){
    ctx.beginPath();
    ctx.moveTo(x, y+h*0.2);
    ctx.quadraticCurveTo(x+w*0.5, y-h*0.3, x+w, y+h*0.2);
    ctx.quadraticCurveTo(x+w*0.5, y+h, x, y+h*0.2);
    ctx.closePath();
    ctx.fill();
  }
  function star(x,y, outer, inner, spikes, color){
    ctx.fillStyle = color;
    let rot = Math.PI/2 * 3;
    let cx = x, cy = y;
    let step = Math.PI / spikes;
    ctx.beginPath();
    ctx.moveTo(cx, cy - outer);
    for (let i = 0; i < spikes; i++) {
      cx = x + Math.cos(rot) * outer;
      cy = y + Math.sin(rot) * outer;
      ctx.lineTo(cx, cy);
      rot += step;
      cx = x + Math.cos(rot) * inner;
      cy = y + Math.sin(rot) * inner;
      ctx.lineTo(cx, cy);
      rot += step;
    }
    ctx.lineTo(x, y - outer);
    ctx.closePath();
    ctx.fill();
  }

  // DRAW
  function drawBG(){
    ctx.fillStyle = theme.bg(W,H);
    ctx.fillRect(0,0,W,H);
  }
  function drawTrail(){
    // tinted low-alpha overlay for motion persistence (softer than pure black)
    ctx.fillStyle = theme.tint;
    ctx.fillRect(0,0,W,H);
  }

  function draw(dt){
    for(let i=ents.length-1;i>=0;i--){
      const e = ents[i];
      const col = e.col;
      switch(e.mode){
        case 0: { // soft ripple
          e.r += e.rSp * (60*dt);
          e.a *= 0.988;
          if(e.a<0.02 || e.r>Math.max(W,H)*1.1){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation = theme.comp;
          ctx.globalAlpha = 0.22*e.a;
          ctx.strokeStyle = col;
          ctx.lineWidth = e.lw;
          ctx.beginPath(); ctx.arc(e.x,e.y,e.r,0,Math.PI*2); ctx.stroke();
          ctx.globalAlpha = 0.10*e.a;
          const g = ctx.createRadialGradient(e.x,e.y,Math.max(0,e.r-16), e.x,e.y,e.r+8);
          g.addColorStop(0,'rgba(255,255,255,0)'); g.addColorStop(1, col+'40');
          ctx.fillStyle=g; ctx.beginPath(); ctx.arc(e.x,e.y,e.r+8,0,Math.PI*2); ctx.fill();
          ctx.globalAlpha = 1; ctx.globalCompositeOperation='source-over';
          break;
        }
        case 1: { // floral mist
          e.t += 60*dt;
          const k = Math.min(1, e.t/e.life);
          const ox = e.dx * k, oy = e.dy * k;
          const alpha = Math.pow(1-k, 1.5) * (e.alpha||0.8);
          ctx.globalCompositeOperation = 'lighter';
          ctx.globalAlpha = 0.6*alpha;
          ctx.translate(e.x+ox, e.y+oy);
          ctx.rotate(e.rot);
          const grd = ctx.createLinearGradient(0,0,0,e.h);
          grd.addColorStop(0,'#ffffff'); grd.addColorStop(1,col);
          ctx.fillStyle = grd;
          roundPetal(0,0,e.w,e.h);
          ctx.setTransform(dpr,0,0,dpr,0,0);
          if(k>=1){ ents.splice(i,1); }
          break;
        }
        case 2: { // calm sparkles
          e.x += e.vx*dt; e.y += e.vy*dt;
          e.vx *= 0.987; e.vy *= 0.987; e.a *= 0.975;
          if(e.a<0.02){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation='lighter';
          ctx.globalAlpha = 0.75*e.a;
          ctx.translate(e.x,e.y); ctx.rotate(e.spin*dt*0.5);
          star(0,0,e.size*2, e.size, 5, col);
          ctx.setTransform(dpr,0,0,dpr,0,0);
          break;
        }
        case 3: { // ink drift
          e.r += e.rSp*dt;
          e.a *= 0.986;
          if(e.a<0.02){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation='source-over';
          const g = ctx.createRadialGradient(e.x,e.y,0, e.x,e.y,e.r);
          g.addColorStop(0, col+'55'); g.addColorStop(1, col+'00');
          ctx.globalAlpha = 0.35*e.a;
          ctx.fillStyle=g; ctx.beginPath(); ctx.arc(e.x,e.y,e.r,0,Math.PI*2); ctx.fill();
          break;
        }
        case 4: { // slow swirls
          e.ang += 1.4*dt; e.r += 28*dt; e.a *= 0.986;
          if(e.a<0.03){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation='lighter';
          ctx.globalAlpha = 0.45*e.a;
          ctx.strokeStyle = col; ctx.lineWidth = 1.8;
          ctx.beginPath();
          const sx = e.x + Math.cos(e.ang)*e.r;
          const sy = e.y + Math.sin(e.ang)*e.r;
          ctx.arc(sx, sy, e.w, e.ang, e.ang+1.3);
          ctx.stroke();
          break;
        }
        case 5: { // light rays
          e.len += e.speed*dt; e.a *= 0.975;
          if(e.a<0.02){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation='lighter';
          ctx.globalAlpha = 0.32*e.a;
          ctx.strokeStyle = col; ctx.lineWidth = e.w;
          ctx.beginPath();
          ctx.moveTo(e.x, e.y);
          ctx.lineTo(e.x + Math.cos(e.ang)*e.len, e.y + Math.sin(e.ang)*e.len);
          ctx.stroke();
          break;
        }
        case 6: { // glass shards (soft)
          e.x += e.vx*dt; e.y += e.vy*dt;
          e.vx *= 0.985; e.vy *= 0.985; e.a *= 0.972;
          if(e.a<0.02){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation='lighter';
          ctx.globalAlpha = 0.55*e.a;
          ctx.translate(e.x,e.y); ctx.rotate(e.rot);
          ctx.fillStyle = col;
          ctx.beginPath();
          // rounded triangle
          const s = e.size;
          ctx.moveTo(-s*0.6, 0);
          ctx.quadraticCurveTo(0, -s*0.6, s, 0);
          ctx.quadraticCurveTo(0, s*0.6, -s*0.6, 0);
          ctx.closePath(); ctx.fill();
          ctx.setTransform(dpr,0,0,dpr,0,0);
          break;
        }
        case 7: { // bubbles
          e.x += e.vx*dt; e.y += e.vy*dt;
          e.vx *= 0.988; e.vy *= 0.988; e.a *= 0.988;
          if(e.a<0.03 || e.y+e.r< -20){ ents.splice(i,1); break; }
          ctx.globalCompositeOperation='lighter';
          ctx.globalAlpha = 0.28*e.a;
          ctx.strokeStyle = col; ctx.lineWidth = 1.6;
          ctx.beginPath(); ctx.arc(e.x,e.y,e.r,0,Math.PI*2); ctx.stroke();
          break;
        }
      }
    }
    ctx.globalAlpha=1; ctx.globalCompositeOperation='source-over';
  }

  // RAF
  let last = performance.now();
  function loop(now){
    const dt = Math.min(0.05, (now-last)/1000); last = now;
    drawBG();
    drawTrail();
    ambient(dt);
    draw(dt);
    requestAnimationFrame(loop);
  }
  requestAnimationFrame(loop);

})();
</script>
</body>
</html>
